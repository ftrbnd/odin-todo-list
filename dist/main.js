(()=>{"use strict";class e{constructor(e,t=""){this.title=e,this.description=t,this.items=[]}}class t{constructor(e,t="",o=new Date,c=1){this.title=e,this.description=t,this.dueDate=o||new Date,this.priority=c||1}}function o(e){const t=document.createElement("div");t.classList.add("item");const o=document.createElement("h3");o.textContent=e.title,o.classList.add("title");const l=document.createElement("h4");l.textContent=e.description,l.style.fontStyle="italic",l.style.fontWeight="normal",l.classList.add("desc");const r=document.createElement("h4");r.textContent=`Due date: ${e.dueDate}`,r.style.fontWeight="normal",r.classList.add("dueDate");const n=document.createElement("h4");return n.textContent=`Priority level: ${e.priority}`,n.style.fontWeight="normal",n.classList.add("priority"),t.appendChild(o),t.appendChild(l),t.appendChild(r),t.appendChild(n),t.addEventListener("click",c),t}function c(e){e.stopPropagation(),console.log(`${e.target.tagName} was selected`)}function l(e,c){const l=document.createElement("div");l.classList.add("project");const r=document.createElement("h3");return r.textContent=e.title,r.classList.add("title"),l.appendChild(r),l.addEventListener("click",(()=>{if(localStorage.getItem("main-project-id")==c)return;console.log(`Project "${e.title}" was selected`),document.querySelector("#main-project > h2").textContent=e.title;let l=document.querySelector("div#todo-items");"Default Project"==e.title?localStorage.setItem("main-project-id","default"):localStorage.setItem("main-project-id",localStorage.getItem("user-projects").split(",").length);const r=[],n=localStorage.getItem("user-projects").split(",");for(const e of n)if(e==localStorage.getItem("main-project-id")){const o=localStorage.getItem(`project-${e}-items`).split(",");for(const c of o)"null"!=c&&c&&(console.log(`Found item #${c} under project #${e}`),r.push(new t(localStorage.getItem(`project-${e}-item-${c}-name`),localStorage.getItem(`project-${e}-item-${c}-desc`),localStorage.getItem(`project-${e}-item-${c}-dueDate`),localStorage.getItem(`project-${e}-item-${c}-priority`))))}for(;l.firstChild;)l.removeChild(l.firstChild);const a=document.querySelector("#main-project > p");if(0==r.length)a.textContent="This project has no items",console.log(`${e.title} has no items`);else{a.textContent=e.description||"This is your default project";for(const e of r)e&&l.appendChild(o(e))}})),l}function r(){const e=document.querySelector("form#new-project");console.log("newProjectButton click"),e.style.display?e.removeAttribute("style"):e.style.display="flex"}function n(){const e=document.querySelector("form#new-item");console.log("newItemButton click"),e.style.display?e.removeAttribute("style"):e.style.display="flex"}!function(){const e=document.querySelector("div#header"),t=document.createElement("h1");t.textContent="Todo List",e.appendChild(t)}(),function(){const t=document.querySelector("div#projects"),o=document.querySelector("form#new-project"),c=document.createElement("div");c.setAttribute("id","projects-header");const n=document.createElement("h2");n.textContent="My Projects",c.appendChild(n);const a=document.createElement("button");a.id="new-project",a.textContent="New",a.addEventListener("click",r),c.appendChild(a),t.insertBefore(c,o);const i=document.createElement("div");let s;i.id="projects-list",t.appendChild(i);try{s=localStorage.getItem("user-projects").split(",")}catch(e){return console.log("localStorage found no projects.")}console.log(`projects to load: ${s}`);for(const t of s)"null"!=t&&"default"!=t&&(console.log(`cur project: ${t}`),i.appendChild(l(new e(localStorage.getItem(`project-${t}-name`),localStorage.getItem(`project-${t}-desc`)))))}(),function(){const c=document.querySelector("div#default"),r=document.querySelector("form#new-item");localStorage.setItem("main-project-id","default"),localStorage.getItem("user-projects")||localStorage.setItem("user-projects","default");const a=document.createElement("div");a.setAttribute("id","main-project");const i=document.createElement("h2"),s=localStorage.getItem("default-project-name");s?i.textContent=s:(i.textContent="Default Project",localStorage.setItem("project-default-name","Default Project")),a.appendChild(i);const d=document.createElement("p"),m=localStorage.getItem("default-project-desc");m?d.textContent=m:(d.textContent="This is your default project",localStorage.setItem("project-default-desc","This is your default project"));const p=document.createElement("button");p.id="new-item",p.textContent="New",p.addEventListener("click",n),a.appendChild(d),a.appendChild(p),c.insertBefore(a,r);const u=document.createElement("div");let g;u.setAttribute("id","todo-items"),c.appendChild(u);try{g=localStorage.getItem("project-default-items").split(",")}catch(e){g=[],localStorage.setItem("project-default-items",""),console.log("localStorage found no items.")}for(const e of g)"null"!=e&&e&&u.appendChild(o(new t(localStorage.getItem(`project-default-item-${e}-name`),localStorage.getItem(`project-default-item-${e}-desc`),localStorage.getItem(`project-default-item-${e}-dueDate`),localStorage.getItem(`project-default-item-${e}-priority`))));const j=new e(localStorage.getItem("project-default-name")),f=document.querySelector("div#projects-list");f.insertBefore(l(j,"default"),f.firstChild)}(),function(){const t=document.querySelector("div#projects-list"),o=document.querySelector("form#new-project");o.addEventListener("submit",(c=>{c.preventDefault();const r=[...new FormData(c.target).entries()],n=new e(r[0][1],r[1][1]);let a;console.log("Created a new project: ",n);try{a=localStorage.getItem("user-projects").split(",").length+1,console.log(`New project id = ${a}`)}catch(c){a=1,console.log("localStorage couldn't set the project id.")}localStorage.setItem(`project-${a}-name`,n.title),localStorage.setItem(`project-${a}-desc`,n.description),localStorage.setItem(`project-${a}-items`,n.items.join(","));const i=localStorage.getItem("user-projects")+`,${a}`;localStorage.setItem("user-projects",i),t.appendChild(l(n,a)),console.log("Local storage after adding project: ",localStorage),localStorage.setItem("main-project-id",a);const s=document.querySelector("div#todo-items");for(;s.firstChild;)s.removeChild(s.firstChild);document.querySelector("div#main-project > h2").textContent=n.title,document.querySelector("div#main-project > p").textContent=n.description,o.reset(),o.removeAttribute("style")}))}(),function(){const e=document.querySelector("div#todo-items"),c=document.querySelector("form#new-item");c.addEventListener("submit",(l=>{l.preventDefault();const r=[...new FormData(l.target).entries()],n=new t(r[0][1],r[1][1],r[2][1],r[3][1]);console.log("Created a new todo item: ",n);const a=localStorage.getItem("main-project-id");let i;console.log(`New item was created under project id #${a}`);try{i=localStorage.getItem(`project-${a}-items`).split(",").length+1,console.log(`New item id = ${i}`)}catch(l){i=1,console.log("Local storage couldn't set the item id.")}localStorage.setItem(`project-${a}-item-${i}-name`,n.title),localStorage.setItem(`project-${a}-item-${i}-desc`,n.description),localStorage.setItem(`project-${a}-item-${i}-dueDate`,n.dueDate),localStorage.setItem(`project-${a}-item-${i}-priority`,n.priority);const s=localStorage.getItem(`project-${a}-items`)+`,${i}`;localStorage.setItem(`project-${a}-items`,s),e.appendChild(o(n)),console.log("Local storage after adding item: ",localStorage),c.reset(),c.removeAttribute("style")}))}()})();